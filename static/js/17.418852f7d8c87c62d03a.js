webpackJsonp([17,39],{Gnkd:function(t,e,a){"use strict";e.b=function(t){return Object(i.a)({url:"/v1/stock/statistic",method:"get",params:t})},e.a=function(t){return Object(i.a)({url:"/v1/stock/statistic_export",method:"get",params:t,responseType:"blob"})};var i=a("vLgD")},GyJ7:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("//Fk"),n=a.n(i),r=a("Dd8w"),o=a.n(r),s=a("Gnkd"),l=[{title:"游戏名称",dataIndex:"game_name",align:"center",fixed:"left"},{title:"面值名称",dataIndex:"gold",align:"center"},{title:"面值价格",key:"money",align:"center",scopedSlots:{customRender:"money"}},{title:"正常有效",dataIndex:"s1",align:"center"},{title:"已使用",dataIndex:"s2",align:"center"},{title:"使用失败",dataIndex:"s4",align:"center"},{title:"后台恢复",dataIndex:"s5",align:"center"},{title:"手机端已获取",dataIndex:"s6",align:"center"},{title:"凭证上架",dataIndex:"s8",align:"center"},{title:"禁止使用",dataIndex:"s7",align:"center"},{title:"总数",dataIndex:"total",align:"center",fixed:"right"}],c={components:{OnSearch:a("rtPm").default},data:function(){return{data:[],pagination:{pageSize:this.$store.getters.pagesize},loading:!1,columns:l,totalMoney:0,name:"",filters:{},search:{}}},mounted:function(){this.fetch({pageSize:this.pagination.pageSize}),console.log(this.config)},watch:{name:function(t,e){""==t&&this.fetch({pageSize:this.pagination.pageSize})}},methods:{onSearch:function(t){this.search=t,this.fetch(o()({pageSize:this.pagination.pageSize},t))},getPagination:function(){return{pageSize:this.pagination.pageSize,page:this.pagination.current,sortField:this.pagination.sortField,sortOrder:this.pagination.sortOrder}},onAdd:function(){this.fetch({pageSize:this.pagination.pageSize})},onEdit:function(){this.fetch(this.getPagination())},status:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){var e=this;status({id:t}).then(function(t){e.fetch(e.getPagination())})}),handleTableChange:function(t,e,a){var i=o()({},this.pagination);i.current=t.current,i.sortField=a.field,i.sortOrder=a.order,this.pagination=i,this.filters=e,this.fetch(o()({pageSize:t.pageSize,page:t.current,sortField:a.field,sortOrder:a.order},e,this.search))},fetch:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.loading=!0,Object(s.b)(e).then(function(e){console.log(e.data);var a=o()({},t.pagination),i=e.data;t.data=i.data,t.totalMoney=i.totalMoney,a.total=i.total,t.pagination=a,t.loading=!1})},del:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){var e=this;this.$confirm({content:"确认删除？",cancelText:"取消",okText:"删除",onOk:function(){return new n.a(function(a,i){del({id:t}).then(function(t){e.$message.success("删除成功"),e.fetch(o()({pageSize:e.pagination.pageSize,page:e.pagination.current,sortField:e.pagination.sortField,sortOrder:e.pagination.sortOrder},e.filters)),e.destroyAll()})})},onCancel:function(){e.destroyAll(),e.$message.info("取消删除",2)}})}),destroyAll:function(){this.$destroyAll()}}},d={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-row",{staticStyle:{"z-index":"2"}},[a("a-col",{attrs:{xs:16,sm:16,md:16,lg:20,xl:20}},[a("on-search",{on:{search:t.onSearch}})],1),t._v(" "),a("a-col",{style:{float:"right",marginRight:"10px",marginTop:"10px"},attrs:{xs:4,sm:4,md:4,lg:3,xl:3}},[a("a-tag",{attrs:{color:"#108ee9"}},[t._v("总额: "+t._s(t.totalMoney))])],1)],1),t._v(" "),a("a-row",[a("a-col",[a("a-table",{attrs:{columns:t.columns,rowKey:function(t){return t.id},dataSource:t.data,pagination:t.pagination,loading:t.loading,scroll:{x:900}},on:{change:t.handleTableChange},scopedSlots:t._u([{key:"money",fn:function(e){return a("span",{},[t._v(t._s(e.money)+"元")])}},{key:"totalMoney",fn:function(e){return a("span",{},[t._v(t._s(parseInt(e.total)*parseFloat(e.money)))])}}])})],1)],1),t._v(" "),a("a-divider")],1)},staticRenderFns:[]};var u=a("VU/8")(c,d,!1,function(t){a("zeyj")},null,null);e.default=u.exports},MwqU:function(t,e){},rtPm:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("AaXs"),n=a("rxb8"),r=a("vMJZ"),o=a("Gnkd"),s=a("+xxY"),l=a("KlBG"),c=a("3UNf"),d={components:{StartTime:s.default,EndTime:l.default},data:function(){return{formLayout:"horizontal",form:this.$form.createForm(this,{name:"coordinated"}),games:[],prices:[],users:[]}},created:function(){this.getGameList(),this.getUserList("son")},methods:{handleSubmit:function(t){var e=this;t.preventDefault(),this.form.validateFields(function(t,a){t||(console.log("Received values of form: ",a),e.$emit("search",a))})},exportStatisticStock:function(){Object(o.a)(this.form.getFieldsValue()).then(function(t){console.log(t);c(t.data,"库存统计.xlsx")})},handleGameChange:function(t){console.log("selected "+t),t||this.form.setFieldsValue({price_id:void 0}),this.getPriceList(t)},handleTypeChange:function(t){this.form.setFieldsValue({user_id:void 0}),this.getUserList(t)},filterOption:function(t,e){return e.componentOptions.children[0].text.toLowerCase().indexOf(t.toLowerCase())>=0},getGameList:function(){var t=this;Object(i.e)().then(function(e){t.games=e.data})},getPriceList:function(t){var e=this;Object(n.g)({game_id:t}).then(function(t){e.prices=t.data})},getUserList:function(t){var e=this;Object(r.p)({user_type:t}).then(function(t){e.users=t.data})},reset:function(){this.form.resetFields()}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{"z-index":"999"}},[a("a-form",{attrs:{form:t.form,layout:"inline"},on:{submit:t.handleSubmit}},[a("a-row",{staticStyle:{height:"60px","margin-left":"10px"}},[a("a-col",{attrs:{span:24}},[a("a-row",[a("a-col",{staticStyle:{"margin-top":"10px"},attrs:{xs:20,sm:16,md:10,lg:7,xl:5}},[a("a-form-item",[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["game_id"],expression:"['game_id']"}],staticStyle:{width:"160px"},attrs:{showSearch:"",placeholder:"选择游戏",optionFilterProp:"children",filterOption:t.filterOption,allowClear:"",size:"small"},on:{change:t.handleGameChange}},t._l(t.games,function(e){return a("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])}),1)],1)],1),t._v(" "),a("a-col",{staticStyle:{"margin-top":"10px"},attrs:{xs:20,sm:16,md:10,lg:7,xl:5}},[a("a-form-item",[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["price_id"],expression:"['price_id']"}],staticStyle:{width:"160px"},attrs:{showSearch:"",placeholder:"选择面值",optionFilterProp:"children",filterOption:t.filterOption,allowClear:"",size:"small"}},t._l(t.prices,function(e){return a("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.gold))])}),1)],1)],1),t._v(" "),a("a-col",{staticStyle:{"margin-top":"10px"},attrs:{xs:20,sm:16,md:10,lg:8,xl:6}},[a("a-form-item",[a("start-time",{directives:[{name:"decorator",rawName:"v-decorator",value:["start_time"],expression:"['start_time']"}]})],1)],1),t._v(" "),a("a-col",{staticStyle:{"margin-top":"10px"},attrs:{xs:20,sm:16,md:10,lg:8,xl:6}},[a("a-form-item",[a("end-time",{directives:[{name:"decorator",rawName:"v-decorator",value:["end_time"],expression:"['end_time']"}]})],1)],1),t._v(" "),a("a-col",{staticStyle:{"margin-top":"10px"},attrs:{xs:20,sm:16,md:10,lg:7,xl:5}},[a("a-form-item",[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["user_type"],expression:"['user_type']"}],staticStyle:{width:"160px"},attrs:{showSearch:"",placeholder:"选择账户类型",allowClear:"",size:"small"},on:{change:t.handleTypeChange}},[a("a-select-option",{attrs:{value:"son"}},[t._v("子账户")]),t._v(" "),a("a-select-option",{attrs:{value:"user"}},[t._v("主账户")])],1)],1)],1),t._v(" "),a("a-col",{staticStyle:{"margin-top":"10px"},attrs:{xs:20,sm:16,md:10,lg:7,xl:5}},[a("a-form-item",[a("a-select",{directives:[{name:"decorator",rawName:"v-decorator",value:["user_id"],expression:"['user_id']"}],staticStyle:{width:"160px"},attrs:{showSearch:"",placeholder:"选择用户",optionFilterProp:"children",filterOption:t.filterOption,allowClear:"",size:"small"}},t._l(t.users,function(e){return a("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v(t._s(e.name))])}),1)],1)],1),t._v(" "),a("a-col",{staticStyle:{"margin-top":"10px"},attrs:{xs:20,sm:16,md:10,lg:3,xl:2}},[a("a-form-item",[a("a-button",{attrs:{size:"small",type:"primary","html-type":"submit"}},[t._v("搜索")])],1)],1),t._v(" "),a("a-col",{staticStyle:{"margin-top":"10px"},attrs:{xs:20,sm:16,md:10,lg:3,xl:2}},[t.hasPermission("statistic.export")?a("a-form-item",[a("a-button",{attrs:{size:"small",type:"primary"},on:{click:t.exportStatisticStock}},[t._v("导出")])],1):t._e()],1)],1)],1)],1)],1)],1)},staticRenderFns:[]};var m=a("VU/8")(d,u,!1,function(t){a("MwqU")},"data-v-6e2a079c",null);e.default=m.exports},zeyj:function(t,e){}});
//# sourceMappingURL=17.418852f7d8c87c62d03a.js.map